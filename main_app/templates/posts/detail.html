{% extends 'base.html' %}
{% load static %}


{% block title %}
My Post
{% endblock %}

{% block content %}
<h1>{{post.user.username}}</h1>
<div>
    {{ post.title }}
    {{ post.description }}
    <img src="{{ post.photo.url }}" alt="" onerror="this.src='{% static 'images/default_post_img.png' %}';">
    <h2>{{ post.city }}</h2>
    {% if request.user == post.user %}
    <a class="btn" href="{% url 'edit_post' post.id%}">Edit Post</a>
    
    <button id="confirm-delete">Delete Post</button>
    <form action="{% url 'delete_post' post.id %}" class="hidden delete-form" method="post">
    {% csrf_token %}
        <button type="submit" class="btn">Click to Confirm Deletion</button>
    </form>
    {% endif %}
     <button class="add-comment btn">Add Comment</button>
    <form action="" method="POST" class="hidden comment-form">
    {% csrf_token %}
       {{form.as_p}}
       <button type="submit" class="btn">Submit</button>
       <button type= "button" class="btn cancel-comment">Cancel</button>
    </form>
    <ul class="comment-list">
    <h4>{% if comments.count < 1 %}
    There are no comments...
    {% elif comments.count == 1 %}
    {{comments.count}} comment
    {% else %}
    {{comments.count}} comments
    {% endif %}
    </h4>
    {% for comment in comments %}
    <h4 class="comment">{{comment.user.username}}</h4>
    <p class="comment-content">{{comment.content}}</p>
    {% if request.user == comment.user %}
    <form action="{% url 'edit_comment' post.id comment.id %}" method="POST" class="hidden edit-comment-form">
    {% csrf_token %}
       {{form.as_p}}
       <button type="submit" class="btn">Update</button>
       <button type= "button" class="btn cancel-edit-comment">Cancel</button>
    </form>
    <button type="button" class="edit-comment btn">Edit</button>
    <form action="{% url 'delete_comment' post.id comment.id %}" method="POST" class="delete-comment-form">
    {% csrf_token %}
       <button type="submit" class="btn red">Delete</button>
    </form>
    {% endif %}
    {% endfor %}
    </ul>
</div>


{% endblock %}